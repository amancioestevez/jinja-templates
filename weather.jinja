{% macro weather_condition_to_emoji(condition="default") %}
  {% set emoji_map = {
    'sunny': 'â˜€ï¸',
    'clear-night': 'ğŸŒƒ',
    'partlycloudy': 'ğŸŒ¤ï¸',
    'cloudy': 'â˜ï¸',
    'rainy': 'ğŸŒ§ï¸',
    'pouring': 'â˜”',
    'lightning': 'âš¡',
    'lightning-rainy': 'â›ˆï¸',
    'snowy': 'ğŸŒ¨ï¸',
    'snowy-rainy': 'ğŸŒ§ï¸â„ï¸',
    'hail': 'ğŸ¥¶ğŸŒ§ï¸',
    'fog': 'ğŸŒ«ï¸',
    'windy': 'ğŸ’¨',
    'windy-variant': 'ğŸŒ¬ï¸',
    'exceptional': 'â—â—â—',
    'default': 'â“'
  } %}
  {{ emoji_map.get(condition, emoji_map['default']) }}
{% endmacro %}

{%- macro format_day_forecast(forecast_data, day_name) -%} 
* \* {{ day_name }}:* 
{% if forecast_data.condition %} â˜ï¸ CondiciÃ³n: {{ forecast_data.condition | replace('-', ' ') }}{% endif %}
{% if forecast_data.temperature is defined %} ğŸŒ¡ï¸ Temperatura MÃ¡xima: {{forecast_data.temperature | replace('.', '\.') }} Â°C{% endif%}
{% if forecast_data.templow is defined %} ğŸ¥¶ Temperatura MÃ­nima: {{forecast_data.templow | replace('.', '\.') }} Â°C{% endif %}
{% if forecast_data.precipitation_probability is defined %} ğŸŒ§ï¸ Probabilidad de Lluvia: {{ forecast_data.precipitation_probability }} %{% endif %}
{%- endmacro -%}

{%- macro forecast_three_days(weather_forecast) -%} 
{% if weather_forecast and weather_forecast['weather.aemet'] and weather_forecast['weather.aemet'].forecast -%} 
{% if weather_forecast['weather.aemet'].forecast[1] %}{{- format_day_forecast(weather_forecast['weather.aemet'].forecast[0], 'Tiempo para hoy') }}{% endif %}
{% if weather_forecast['weather.aemet'].forecast[1] %}{{ format_day_forecast(weather_forecast['weather.aemet'].forecast[1], 'Tiempo para maÃ±ana') }}{% endif %}
{% if weather_forecast['weather.aemet'].forecast[2] %}{{ format_day_forecast(weather_forecast['weather.aemet'].forecast[2], 'Tiempo para pasado maÃ±ana') }}{% endif %}
{% else %} âš ï¸ No se pudo obtener la informaciÃ³n del tiempo\. {% endif %}
{%- endmacro -%}